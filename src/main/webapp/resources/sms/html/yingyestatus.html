<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>链家网-sms系统</title>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="../asset/css/common.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Bootstrap -->
<link href="../dep/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">

<!--[if lt IE 9]>
 <script type="text/javascript" src="../dep/support/html5.js"></script>
 <script src="../dep/support/respond.min.js"></script>
<![endif]-->
  
  <link rel="stylesheet" type="text/css" href="../asset/css/index.css">
  </head>
  <body>

<div class="max-wrapper">
  <header class="header">
  <div class="logo">
    <p class="sms">SMS<span class="sys-name">链家店面管理系统</span></p>
    <p class="sms-all">Store Management System</p>
  </div>
   <span class="sms-current-user" id="showUserName"></span>
   <script type="text/template" style="display:none" id="showUserNameTemplate">
    <%if(code ==1){%>
      你好，<%=data.userName%><a href="#">退出</a>
    <%}else{%>
      接口错误，请刷新重试
    <%}%>
   </script>
</header>

<div class="navbar">
  <div class="navbar-inner">
    <ul class="nav">
      <li class="pageIndex"><a href="./smsIndex.html">首页</a></li>
      <li class="pageYyStatus"><a href="./mendianStatus.html">营业状况</a></li>
      <li class="pagePersonMan"><a href="./manager.html">师徒关系</a></li>
      <li class="importPage"><a href="./import.html">录入成本</a></li>
      <li class="pageShops"><a href="#">店面通</a></li>
    </ul>
  </div>
</div>  
  <ul class="nav nav-tabs">
<!--
<li class="companyPanel">
  <a href="./yingyestatus.html">公司营业状况</a>
</li>
<li class="daquPanel">
  <a href="./areastatus.html">大区营业状况</a>
</li>
-->
<li class="shopPanel"><a href="./mendianStatus.html">门店营业状况</a></li>
<li class="personPanel"><a href="./personstatus.html">经纪人作业详情</a></li>
</ul> 
  <form id="smsSearchForm" class="form-inline sms-search" onsubmit="return false;">
    选择时间
    <select class="input-small year" name="year"></select>
    <select class="input-mini month" name="month"></select>

    <a href="javascript:;" class="actCurrentMonth">本月</a>

    <div class="btn-group allArea">
       <label class="dropdown-toggle">
        <input type="text" name="area" class="input-medium" value="" placeholder="全部大区">
        <input type="hidden" name="areaVal" value="">
        <span class="icon icon-calendar"></span>
      </label>
      <ul class="dropdown-menu">
        
      </ul>
    </div>
   
    <div class="btn-group allShops">
      <label>
        <input type="text" name="shop" class="input-medium" value="" placeholder="全部门店">
        <input type="hidden" name="shopVal" value="">

        <span class="icon icon-calendar"></span>
      </label>
       <ul class="dropdown-menu">
        
      </ul>
    </div>

    <button type="button" class="btn actSearch">查看</button>
    <button type="button" class="btn actExport">导出</button>
  </form>

  <p>2014年11月，XX分公司总业绩为<span class="green">1234567.89</span>，成本总计1134567.89，利润为200000，累计利润为400000。</p>

  <div class="comp" id="revenueTable">
    <p class="title">营收详情</p>
    <div class="comp-content content" style="display:none">
      
    </div>
    <div class="comp-content loading">
      <div class="loading">loading...</div>
    </div>
    <script type="text/template" class="template">
     <table class="table table-bordered table-hover">
        <thead>
          <tr>
          <%for(var i = 0 ; i < label.length;i++){%>
            <th><%=label[i]%></th>
          <%}%>
          </tr>
        </thead>
        <tbody>
        <%for(var j = 1 ; j < dataList.length;j++){%>
          <tr>
          <%for(var i = 0 ; i < dataList[j].length;i++){%>
            <td><%=dataList[j][i]%></td>
          <%}%>
          </tr>
        <%}%>
        </tbody>
      </table>
    </script>
  </div>

  <div class="comp">
    <p class="title">各项成本占总成本比</p>
    <div class="comp-content content" id="pieChart">
      <div class="loading">loading...</div>
    </div>
     <script type="text/template" id="pieChartTemplate">
      <p><%=startTime%>，<%=shopName%>店总业绩为<%=total%>，成本总计<%=cost%>，利润为<%=profit%>，累计利润为<%=totalProfit%>。</p>
      <div class="chart chart-dom">
      </div>
    </script>
  </div>
  <div class="comp">
    <p class="title">各项成本占总业绩比</p>
    <div class="comp-content content" id="barChart">
      <div class="loading">loading...</div>
    </div>
     <script type="text/template" id="barChartTemplate">
      <div class="chart chart-dom">
      </div>
      <div class="chart-bottom">
        <table class="table table-bordered">
          <tbody>
            <tr>
              <td></td>
              <%for(var i = 0 ,len = list.length;i<len;i++){%>
              <td><%=list[i].name%></td>
              <%}%>
            </tr>
            <tr>
              <td>业绩</td>
              <%for(var i = 0 ,len = list.length;i<len;i++){%>
              <td><%=list[i].value%></td>
              <%}%>
            </tr>
          </tbody>
        </table>
      </div>
    </script>
  </div>
</div>
<script type="text/javascript">
var pageConfig = {
  page:"pageYyStatus,companyPanel"
};

</script>
<footer class="footer">
	<p>北京链家房地产经纪有限公司</p>
	<p>Copyright©2014 All rights Reserved</p>
</footer>
<script src="../dep/esl.min.js"></script>
<script src="../dep/jquery/jquery.min.js"></script>
<script src="../dep/bootstrap/js/bootstrap.min.js"></script>
<script src="../dep/support/underscore.js"></script>
<script src="../dep/support/backbone.js"></script>
<script src="../asset/js/common/common.js"></script>
<script type="text/javascript">

require.config({
	baseUrl: "http://dongyajie.lianjia.com:8011/sms/asset/js",
	paths: {
		'echarts' : '../../dep/echarts-1.4.1/build/echarts',
		'echarts/chart/bar' : '../../dep/echarts-1.4.1/build/echarts',
		'echarts/chart/line' : '../../dep/echarts-1.4.1/build/echarts',
		'echarts/chart/pie' : '../../dep/echarts-1.4.1/build/echarts',
		'common': 'common/common'
	},
	urlArgs:  "v=1"
});
// 基础服务
require(["sms/smscommon"],function(){
	$.listener.trigger("commmReady");
})
</script> 
<script type="text/javascript">

require(["sms/report"],function(revenue){
  var config = require("sms/config");

  revenue.init({
    // list 地址
    el:$("#smsSearchForm"),
    repUrl:config.api.areaDataList
    //  
  });


  var barModel = new $.BarChartModel({
    name:""
  });

  var pieModel = new $.PieChartModel();
  
  new $.ChartView({
    el:"#barChart",
    model:barModel
  })

  new $.ChartView({
    el:"#pieChart",
    model:pieModel
  });
  var collection = revenue.reportView.collection;
  collection.on("sync",function(){
    var data =collection.toJSON()[0];
    console.log(data);
  })
})


</script>
  </body>
</html>