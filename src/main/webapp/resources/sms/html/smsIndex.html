<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>链家网-sms系统</title>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="../asset/css/common.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Bootstrap -->
<link href="../dep/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">

<!--[if lt IE 9]>
 <script type="text/javascript" src="../dep/support/html5.js"></script>
 <script src="../dep/support/respond.min.js"></script>
<![endif]-->
  
  <link rel="stylesheet" type="text/css" href="../asset/css/index.css">
  </head>
  <body>

<div class="max-wrapper">
  <header class="header">
  <div class="logo">
    <p class="sms">SMS<span class="sys-name">链家店面管理系统</span></p>
    <p class="sms-all">Store Management System</p>
  </div>
   <span class="sms-current-user" id="showUserName"></span>
   <script type="text/template" style="display:none" id="showUserNameTemplate">
    <%if(code ==1){%>
      你好，<%=data.userName%><a href="<%=config.logoutUrl%>">退出</a>
    <%}else{%>
      接口错误，请刷新重试
    <%}%>
   </script>
</header>

<div class="navbar">
  <div class="navbar-inner">
    <ul class="nav">
      <li class="pageIndex"><a href="./smsIndex.html">首页</a></li>
      <li class="pageYyStatus"><a href="./mendianStatus.html">营业状况</a></li>
      <li class="pagePersonMan"><a href="./manager.html">师徒关系</a></li>
      <li class="importPage"><a href="./import.html">录入成本</a></li>
      <li class="pageShops"><a href="#">店面通</a></li>
    </ul>
  </div>
</div>  


  <div class="jingjinren-info clearfix" id="jingjirenInfo">
    <div class="loading">loading...</div>
  </div>
  <script type="text/template" style="display:none" id="jingjirenInfoTemplate">
    <%if(code == 1){%>
          <div class="user-detail fuzong">
            <img class="left" src="<%=data.userPic%>">
            <p><%=data.area%> <%=data.levelName%></p>
            <p><h4><%=data.userName%></h4></p>
            <div>
              <div class="user-value clearfix">
                <p class="person">
                  <i></i>经纪人<span><%=data.jingjirenNum%>人</span>
                </p>
                <p class="cur-value">
                  <i></i>本月当前业绩<span><%=data.curValue%></span>
                </p>
                <p class="cur-profit">
                  <i></i>本月当前利润<span><%=data.curProfit%></span>
                </p>
              </div>
            </div>
          </div>
    <%}else{%>
        接口错误，请<a href="javascript:location.reload();">刷新</a>重试
    <%}%>
    
  </script>

  <div id="reports">
    <div class="loading">loading...</div>
</div>

<script type="text/template" id="reportsTemplate">
  <%for(var i = 0 ,len = list.length; i < len;i++){%>
    <div class="comp" compType="<%=list[i].type%>" id="comp<%=i+1%>">
      <p class="title">
        <%=list[i].name%>
        <a class="pull-right" href="./mendianStatus.html?time=<%=$.formatDate(new Date(parseInt(list[i].startTime)),"yyyy-M")%>">详细数据&gt;&gt;</a>
      </p>
      <div class="comp-content" >
        <!--表格-->
        <%if(list[i].type == "table"){%>
          <table class="table table-bordered table-hover">
          <thead>
            <tr>
            <%for(var i = 0 ; i < list[i].label.length;i++){%>
              <th><%=list[i].label[i]%></th>
            <%}%>
            </tr>
          </thead>
          <tbody>
          <%for(var j = 1 ; j < list[i].dataList.length;j++){%>
            <tr>
            <%for(var i = 0 ; i < list[i].dataList[j].length;i++){%>
              <td><%=list[i].dataList[j][i]%></td>
            <%}%>
            </tr>
          <%}%>
          </tbody>
        </table>
        <%}else if(list[i].type == "bar"){%>
            <div class="chart chart-dom"></div>
        <%}if(list[i].type == "pie"){%>
            <div class="chart chart-dom"></div>
        <%}%>
      </div>
    </div>
  <%}%>
</script> 

</div>
<script type="text/javascript">
// 页面配置
var pageConfig = {
  page:"pageIndex"
};
</script>

<footer class="footer">
	<p>北京链家房地产经纪有限公司</p>
	<p>Copyright©2014 All rights Reserved</p>
</footer>
<script src="../dep/esl.min.js"></script>
<script src="../dep/jquery/jquery.min.js"></script>
<script src="../dep/bootstrap/js/bootstrap.min.js"></script>
<script src="../dep/support/underscore.js"></script>
<script src="../dep/support/backbone.js"></script>
<script src="../asset/js/common/common.js"></script>
<script type="text/javascript">

require.config({
	baseUrl: "../asset/js",
	paths: {
		'echarts' : '../../dep/echarts-1.4.1/build/echarts',
		'echarts/chart/bar' : '../../dep/echarts-1.4.1/build/echarts',
		'echarts/chart/line' : '../../dep/echarts-1.4.1/build/echarts',
		'echarts/chart/pie' : '../../dep/echarts-1.4.1/build/echarts',
		'common': 'common/common'
	},
	urlArgs:  "v=1"
});
// 基础服务
require(["sms/smscommon"],function(common){
	
})
</script> 
<script type="text/javascript">
require(["sms/showUserInfoView"],function(view){
  
})

$.listener.on("commmReady",function(){
  var config = $.config;
  var reqModel = new $.BaseModel({},{
    url:config.api.indexReport
  });
  var reportView = new $.ReportView({
    model:reqModel,
    el:"#reports"
  })
  reportView.parse = function(data){
    var list = data.dataList;
    var result = [];
    for(var i = 0 ,len = list.length;i < len;i++){
      var label = list[i].label.replace(/\'/g,"\"");
      list[i].label = JSON.parse(label);
      var dataList = [];
      for(var j = 0,len1 = list[i].dataList.length; j < len1;j++){
        dataList.push(list[i].dataList[j][0].split(","))
      }
      list[i].dataList = dataList;
      result.push(list[i]);
    }
    return result;
  }
  
  reportView.init();
});

</script>
  </body>
</html>