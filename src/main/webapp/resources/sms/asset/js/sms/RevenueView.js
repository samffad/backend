define("sms/config",function(){var e=$.formatDate(new Date,"yyyyMM"),t=$.parseURL(location.href),a=t.scheme+":"+t.slash+t.host+(t.port?":"+t.port:""),n=(encodeURIComponent(a+"/"),(new Date).getTime()),r={logoutUrl:a+"/logout",loginUrl:a+"/",changeStore:"/login",api:{userLogin:"../test/logon.json",userInfo:"/userinfo/index.json",indexReport:"/userinfo/indexdata.json?viewType=bar,pie&yearMonth="+e,reportData:"/managerDetail/liststoredetail.json",reportDataDown:"/managerDetail/downloadexcel.json",jingjirendata:"/brokerDetail/listbrokerdetail.json",jingjirendataDown:"/brokerDetail/downloadexcel.json",jingjirenlist:"/mentor/getAllBrokers.json",jingjirensearch:"/mentor/getSuggest.json",jingjirenbuild:"/mentor/addRelation.json",jingjirenupdate:"/mentor/modifyRelation.json",jingjirendelete:"/mentor/deleteRelation.json",areaDataList:"../test/dataList.json",importFile:"/typecost/upload.json",daquReportData:"/areaDetail/listareadetail.json",daquReportDataDown:"/areaDetail/downloadexcel.json",fuzongReportData:"/companyDetail/listcompanydetail.json",fuzongReportDataDown:"/companyDetail/downloadexcel.json",storeSearch:"/areaDetail/searchstore.json",daquSearch:"/companyDetail/searcharea.json"}};for(var i in r.api)r.api[i]=r.api[i].indexOf("&")>=0?r.api[i]+"&__random="+n+"&":r.api[i]+"?__random="+n+"&";return r}),define("sms/suggestView",function(){function e(e){return e.val().length}var t=$.BaseModel,a=Backbone.Model.extend(),n=Backbone.Collection.extend({model:a,parse:function(e){return e?e.data:[]}}),r=t.extend({initialize:function(){var e=this,t=this.get("collection");e.on("change",function(){t.url=$.joinURL(e.get("url"),e.get("args"));var a=e.get("args")[e.keyword]||"";if(e.isStatic&&e.collData){for(var n=[],r=0;r<e.collData.length;r++){var i=e.collData[r];i.name.indexOf(a)>=0&&n.push(i)}t.set(n),t.trigger("sync")}else t.fetch()})},setArgs:function(e){var t=this,a=_.clone(t.get("args"));$.extend(a,e),t.set("args",a),t.trigger("change")},saveDataList:function(e){var t=this;t.collData=e}}),i=Backbone.View.extend({template:_.template('<%for(var i =0;i<list.length;i++){%><li actVal="<%=list[i].value%>"><a href="javascript:;"><%=list[i].name%><%=list[i].value?("("+list[i].value+")"):""%></a></li><%}%>'),className:"ttt",initialize:function(){var e=this;this.listenTo(e.collection,"sync",function(){e.render()}),e.on("enter",function(t){e.$(".dropdown-menu").hide();var a=e.collection.at(t);a&&(e.$("[type='hidden']").val(a.get("value")),e.$("[type='text']").val(a.get("name"))),e.trigger("selectValue",a)}),$(document.body).on("click",function(){e.$(".dropdown-menu").hide()})},clearData:function(){var e=this;e.$("[type='hidden']").val(""),e.trigger("selectValue",!1)},render:function(){var e=this,t=e.$(".dropdown-menu"),a=e.collection.toJSON();a.length?(t.html(e.template({list:a})),t.show()):t.hide()},events:{"keyup input":"keyup","keydown input":"keydown","focus input":"setSearchValue","click input":"setSearchValue","click .actFocus":"focus","mouseenter li":"mouseenter","click li":"select"},focus:function(e){var t=this;$(e.currentTarget).blur();var a=this.$("input"),n={};return n[a.attr("name")]="",t.model.setArgs(n),!1},keydown:function(e){$.inArray(e.keyCode,[38,40,13])>=0&&(e.preventDefault(),e.stopPropagation())},keyup:function(e){var t=this;switch(e.keyCode){case 8:t.clearData(),t.setSearchValue();break;case 38:return t.pre(),e.preventDefault(),e.stopPropagation(),!1;case 40:return e.preventDefault(),e.stopPropagation(),t.next(),!1;case 13:return t.enter(),!1;default:t.setSearchValue()}return!1},scrollToCur:function(e){e=$(e);var t=e.parent(),a=e.get(0).offsetTop;a>t.height()+t.get(0).scrollTop&&(t.get(0).scrollTop=a-t.height()+2*e.height()),t.get(0).scrollTop>a&&(t.get(0).scrollTop=a-t.height())},pre:function(){var e=this,t=e.$("li");if(t.length){var a=e._getCurSelect(),n=-1;a>=0&&(n=a-1),t.removeClass("active"),t.eq(n).addClass("active"),e.scrollToCur(t.eq(n))}},next:function(){var e=this,t=e.$("li");if(t.length){var a=e._getCurSelect(),n=-1;n=a>=t.length-1?0:a+1,t.removeClass("active"),t.eq(n).addClass("active"),e.scrollToCur(t.eq(n))}},enter:function(){var e=this,t=e._getCurSelect();e.trigger("enter",-1==t?0:t)},_getCurSelect:function(){for(var e=this,t=e.$("li"),a=0,n=t.length;n>a;a++)if(t.eq(a).hasClass("active"))return a;return-1},select:function(e){var t=e.currentTarget;this.$("li").removeClass("active"),$(t).addClass("active"),this.enter()},mouseenter:function(e){var t=e.currentTarget;this.$("li").removeClass("active"),$(t).addClass("active")},_searchTimeout:!1,setSearchValue:function(){var t=this;t._searchTimeout&&clearTimeout(t._searchTimeout),t._searchTimeout=setTimeout(function(){var a=t.$("input"),n=e(a),r=a.val().substring(0,n),i={};i[a.attr("name")]=r,t.model.setArgs(i)},300)},initSearchData:function(e){var t=this,a=t.$("input");e=e||{},e[a.attr("name")]="";var n=t.model;n.keyword=a.attr("name"),$.ajax({url:$.joinURL(n.get("url"),e)}).success(function(e){var a=t.collection.parse(e);a&&a.length&&t.model.saveDataList(a)})}});return function(e){var t={url:"",args:{},el:"",parse:!1};$.extend(t,e);var a=new n({});t.parse&&(a.parse=t.parse);var o=new r({collection:a,args:t.args,url:t.url}),l=new i({collection:a,model:o,el:t.el});return t.isStatic&&(o.isStatic=!0,l.initSearchData(t.args)),l}}),define("sms/RevenueView",function(require){var e=require("sms/config"),t=require("sms/suggestView"),a=($(".sms-search"),Backbone.View.extend({initialize:function(a,n){var r=this;r.$el.find(".allArea").length&&(r.allArea=t({el:r.$el.find(".allArea"),url:e.api.searchArea,args:{}})),r.$el.find(".allShops").length&&(r.allShops=t({el:r.$el.find(".allShops"),url:e.api.searchArea,args:{}})),r.args=_.extend({},n),r.initDate()},events:{"click .actSearch":"actSearch","click .actExport":"actExport","change .year":"actUpdateMonth","change .month":"actUpdateTime","click .actCurrentMonth":"actCurrentMonth"},getFormValue:function(){for(var e=this,t=e.$el.get(0),a={},n=t.elements,r=0,i=n.length;i>r;r++)if(n[r].name){var o=$(n[r]).val();$(n[r]).attr("placeholder")==o&&(o=""),"yearMonth"==n[r].name&&o.indexOf("null")>=0&&(o=o.replace("null",(new Date).getFullYear())),a[n[r].name]=o}return a},actSearch:function(){var e=this.getFormValue();e.__random=(new Date).getTime(),this.trigger("argsSet",e)},actUpdateTime:function(){var e=$(".year"),t=$(".month");null==e.val()&&(e=(new Date).getFullYear()),$("#yearMonth").val(e.val()+""+t.val())},actUpdateMonth:function(){var e=this,t=$(".year"),a=$(".month"),t=parseInt(t.val()),n=new Date;if(t!=n.getFullYear())for(var r=1;12>=r;r++){var i=10>r?"0"+r:r,o=$("<option value='"+i+"'>"+i+"</option>");curMonth==r&&o.attr("selected","selected"),a.append(o)}e.actUpdateTime()},actCurrentMonth:function(){var e=new Date;this.$el.find(".year").val(e.getFullYear());var t=e.getMonth()+1;t=t>10?t:"0"+t,this.$el.find(".month").val(t),this.actUpdateTime()},initDate:function(){var e=this,t=new Date,a=e.args.year||t.getFullYear(),n=e.args.month||t.getMonth()+1;n=parseInt(n);for(var r=this.$el.find(".year"),i=this.$el.find(".month"),o=2015;o<=t.getFullYear();o++){var l=$("<option value='"+o+"'>"+o+"</option>");a==o&&l.attr("selected","selected"),r.append(l)}for(var o=1;o<=t.getMonth()+1;o++){var s=10>o?"0"+o:o,l=$("<option value='"+s+"'>"+s+"</option>");n==o&&l.attr("selected","selected"),i.append(l)}n=10>n?"0"+n:n,a=a||(new Date).getFullYear(),$("#yearMonth").val(a+""+n)},actExport:function(e){var t=$(e.target),a=t.attr("url");if(a){var n=this.getFormValue(),r=$('<form action="'+a+'" target="downloadIframe" method="get"></form>');for(var i in n)r.append($('<input type="hidden" name="'+i+'" value="'+n[i]+'">'));return $(document.body).append(r),r.submit(),!1}}})),n=$({});return n.init=function(e){var t={el:"",args:{}};_.extend(t,e),n.report=new a({el:t.el},t.args)},n});