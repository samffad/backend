define("sms/config",function(){var e=$.formatDate(new Date,"yyyyMM"),o=$.parseURL(location.href),n=o.scheme+":"+o.slash+o.host+(o.port?":"+o.port:""),t=(encodeURIComponent(n+"/"),(new Date).getTime()),a={logoutUrl:n+"/logout",loginUrl:n+"/",changeStore:"/login",api:{userLogin:"../test/logon.json",userInfo:"/userinfo/index.json",indexReport:"/userinfo/indexdata.json?viewType=bar,pie&yearMonth="+e,reportData:"/managerDetail/liststoredetail.json",reportDataDown:"/managerDetail/downloadexcel.json",jingjirendata:"/brokerDetail/listbrokerdetail.json",jingjirendataDown:"/brokerDetail/downloadexcel.json",jingjirenlist:"/mentor/getAllBrokers.json",jingjirensearch:"/mentor/getSuggest.json",jingjirenbuild:"/mentor/addRelation.json",jingjirenupdate:"/mentor/modifyRelation.json",jingjirendelete:"/mentor/deleteRelation.json",areaDataList:"../test/dataList.json",importFile:"/typecost/upload.json",daquReportData:"/areaDetail/listareadetail.json",daquReportDataDown:"/areaDetail/downloadexcel.json",fuzongReportData:"/companyDetail/listcompanydetail.json",fuzongReportDataDown:"/companyDetail/downloadexcel.json",storeSearch:"/areaDetail/searchstore.json",daquSearch:"/companyDetail/searcharea.json"}};for(var r in a.api)a.api[r]=a.api[r].indexOf("&")>=0?a.api[r]+"&__random="+t+"&":a.api[r]+"?__random="+t+"&";return a}),define("sms/userModel",function(require){function e(e){r=e,window.$currentUser=r.dataList[0],$.listener.trigger("getUserInfo",window.$currentUser)}function o(){window.sessionStorage.removeItem(i)}function n(e){var o=$.parseURL(e),n="";if(o.scheme&&(n+=o.scheme+":"),o.slash&&(n+=o.slash),o.host&&(n+=o.host),o.port&&(n+=":"+o.port),o.path&&(n+="/"+o.path),o.query){var t=$.queryToJson(o.query),a={};for(var r in t)$.inArray(r,d)<0&&(a[r]=t[r]);n=$.joinURL(n,a)}return n}var t=require("sms/config"),a=$.BaseModel,r=!1,i="_userInfoStroage_",s=function(){var e=!1;try{window.sessionStorage&&(e=window.sessionStorage.getItem(i))&&(e=JSON.parse(e))}catch(o){e=!1}return e},l=a.extend({urlRoot:t.api.userInfo,initialize:function(){var o=this;this.set("a","1"),this.once("change",function(){var n=o.toJSON();1==n.code&&(o.set("id","1"),e(o.toJSON()))})},laoding:!1,load:function(){var e=s();e?this.set(e):this.laoding||(this.laoding=!0,this.fetch())}}),d=["logoutUrl","proto_url"],c=!1;return $.listener.on("unlogin",function(){o(),!c&&alert("找不到用户信息"),c=!0;var e=t.loginUrl+"?proto_url="+encodeURIComponent(n(location.href));location.href=e}),$.listener.on("unAuth",function(){alert("没权限"),location.href=t.loginUrl+"?proto_url="+encodeURIComponent(n(location.href))}),new l});