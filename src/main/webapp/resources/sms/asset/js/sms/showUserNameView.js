define("sms/config",function(){var e=$.formatDate(new Date,"yyyyMM"),o=$.parseURL(location.href),n=o.scheme+":"+o.slash+o.host+(o.port?":"+o.port:""),t=(encodeURIComponent(n+"/"),(new Date).getTime()),r={logoutUrl:n+"/logout",loginUrl:n+"/",changeStore:"/login",api:{userLogin:"../test/logon.json",userInfo:"/userinfo/index.json",indexReport:"/userinfo/indexdata.json?viewType=bar,pie&yearMonth="+e,reportData:"/managerDetail/liststoredetail.json",reportDataDown:"/managerDetail/downloadexcel.json",jingjirendata:"/brokerDetail/listbrokerdetail.json",jingjirendataDown:"/brokerDetail/downloadexcel.json",jingjirenlist:"/mentor/getAllBrokers.json",jingjirensearch:"/mentor/getSuggest.json",jingjirenbuild:"/mentor/addRelation.json",jingjirenupdate:"/mentor/modifyRelation.json",jingjirendelete:"/mentor/deleteRelation.json",areaDataList:"../test/dataList.json",importFile:"/typecost/upload.json",daquReportData:"/areaDetail/listareadetail.json",daquReportDataDown:"/areaDetail/downloadexcel.json",fuzongReportData:"/companyDetail/listcompanydetail.json",fuzongReportDataDown:"/companyDetail/downloadexcel.json",storeSearch:"/areaDetail/searchstore.json",daquSearch:"/companyDetail/searcharea.json"}};for(var a in r.api)r.api[a]=r.api[a].indexOf("&")>=0?r.api[a]+"&__random="+t+"&":r.api[a]+"?__random="+t+"&";return r}),define("sms/userModel",function(require){function e(e){a=e,window.$currentUser=a.dataList[0],$.listener.trigger("getUserInfo",window.$currentUser)}function o(){window.sessionStorage.removeItem(i)}function n(e){var o=$.parseURL(e),n="";if(o.scheme&&(n+=o.scheme+":"),o.slash&&(n+=o.slash),o.host&&(n+=o.host),o.port&&(n+=":"+o.port),o.path&&(n+="/"+o.path),o.query){var t=$.queryToJson(o.query),r={};for(var a in t)$.inArray(a,d)<0&&(r[a]=t[a]);n=$.joinURL(n,r)}return n}var t=require("sms/config"),r=$.BaseModel,a=!1,i="_userInfoStroage_",s=function(){var e=!1;try{window.sessionStorage&&(e=window.sessionStorage.getItem(i))&&(e=JSON.parse(e))}catch(o){e=!1}return e},l=r.extend({urlRoot:t.api.userInfo,initialize:function(){var o=this;this.set("a","1"),this.once("change",function(){var n=o.toJSON();1==n.code&&(o.set("id","1"),e(o.toJSON()))})},laoding:!1,load:function(){var e=s();e?this.set(e):this.laoding||(this.laoding=!0,this.fetch())}}),d=["logoutUrl","proto_url"],u=!1;return $.listener.on("unlogin",function(){o(),!u&&alert("找不到用户信息"),u=!0;var e=t.loginUrl+"?proto_url="+encodeURIComponent(n(location.href));location.href=e}),$.listener.on("unAuth",function(){alert("没权限"),location.href=t.loginUrl+"?proto_url="+encodeURIComponent(n(location.href))}),new l}),define("sms/showUserNameView",function(require){if($("#showUserName").length){var e=require("sms/userModel"),o=require("sms/config"),n=Backbone.View.extend({el:"#showUserName",template:_.template($("#showUserNameTemplate").html()),userMenuTemplate:_.template($("#userMenuTemplate").html()),initialize:function(){var e=this;$.listener.on("getUserInfo",function(o,n){e.render(n)})},render:function(e){var n={data:e,code:1,config:o};this.$el.html(this.template(n)),this.$el.show(),e&&!_.isArray(e.permissions)&&e.permissions&&(e.permissions=e.permissions.split(",")),$("#userMenu").html(this.userMenuTemplate(e)),this.trigger("menuReady",e)},load:function(){this.model.load()}});return new n({model:e})}});